		ORG 0
		MOV R13,#1<16 					; INICIJALIZACIJA SP-a

GLAVNI  LDR R1,IZVOR 					; DOHVAT ADRESE IZVORA I ODREDISTA
		LDR R2,ODR
		LDR R6,KR

LOOP	LDR R3,[R1],#%D4 				; DOHVAT PODATKA IZ BLOKA I POSTINDEKSIRANJE
		CMP R3,R6 						; JELI KRAJ BLOKA
		BEQ KRAJ
		CMP R3,#0 						; 0 NIJE U DOMENI FUNKCIJE
		BNE NENUL
		MOV R4,#0
		STR R4,[R2],#%D4				; SPREMI 0 NA ODREDISTE
		B LOOP
		
NENUL	STMFD R13!,{R3} 				; PARAMETAR NA STOG I POZIVANJE POTPROGRAMA
		BL KUB 							; REZ SE VRACA PREKO R0
		SUB R0,R0,#1 					; DJELJENIK
		MOV R3,R3,LSL #1 				; DJELJITELJ
		STMFD R13!,{R0,R3} 				; PARAMETRI NA STOG I POZIVANJE POTPROGRAMA
		BL DIV 							; REZ U R4
		STR R4,[R2],#%D4 				; SPREMANJE NA ODREDISNU ADRESU
		ADD R13,R13,#8 					; CISCENJE STOGA
		B LOOP
		
KRAJ	SWI 123456	
		
KUB     STMFD R13!,{R1,R2} 				; SPREMANJE KONTEKSTA
		ADD R2,R13,#%D8 				; PRESKAKANJE SPREMLJENIH REGISTARA KAKO BI MOGLI DOHVATITI PARAMETAR
		MOV R0,#0
		LDR R0,[R2] 					; DOHVAT PARAMETRA 
		MOV R1,R0
		MUL R0,R0,R1 					; NA KVADRAT
		MUL R0,R0,R1 					; NA TRECU
		LDMFD R13!,{R1,R2} 				; OBNOVA REGISTARA
		MOV PC,LR 						; POVRATAK

DIV		STMFD R13!,{R0,R1,R2} 			; KONTEKST
		ADD R0,R13,#%D12 				; PRESKAKANJE KONTEKSTA
		LDMFD R0,{R1,R2} 				; DOHVAT PARAMETARA - U R1 DJELJENIK, U R2 DJELJITELJ
		MOV R4,#0 						; INICIJALIZACIJA REZULTATA
		MVN R0,#0 						; MASKA ZA NEG BROJEVE
		CMP R1,#0 						; PRETVARANJE NEG U POZ BROJEVE ZBOG KARAKTERISTIKA FUNKCIJE 
		BPL IDUCI
		EOR R1,R1,R0
		ADD R1,R1,#1
		
IDUCI	CMP R2,#0
		BPL DJELI
		EOR R2,R2,R0
		ADD R2,R2,#1
		
DJELI	SUBS R1,R1,R2 					; UZASTOPNO ODUZIMANJE I PROVJERA REZULTATA
		ADDPL R4,R4,#1
		BPL DJELI
		
GOTOV	LDMFD R13!,{R0,R1,R2} 			; OBNOVA KONTEKSTA
		MOV PC,LR 						; POVRATAK

KR		DW 80000000		
ODR		DW 400
IZVOR	DW 100

		ORG 100
		DW 0,3,6,FFFFFFFF,FFFFFFFA,80000000
		ORG 400
		DS %D20
